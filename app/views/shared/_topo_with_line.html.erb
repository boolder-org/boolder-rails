<div class="relative" data-controller="topo-line" data-action="turbo:before-cache@window->topo-line#hidePath" data-topo-line-coordinates-value="<%= line.coordinates.to_json %>" data-topo-line-color-value="<%= uicolor(line.problem.circuit&.color) %>">
  <%= render 'shared/topo_image', topo: line.topo, klass: "sm:rounded-lg" %>
  <% if line.coordinates %>
    <div class="absolute top-0 left-0 w-full">
      <svg data-topo-line-target="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" style="filter: drop-shadow(0px 0px 8px rgba(0.2,0.2,0.2,0.6));"></svg>
    </div>
  <% end %>

  <% (line.topo.lines - [line]).each do |secondary_line| %>
    <% if secondary_line.coordinates %>
      <div class="absolute" style="left:<%= secondary_line.coordinates.first['x']*100 %>%; top:<%= secondary_line.coordinates.first['y']*100 %>%">
        <div class="relative hidden" style="top:-12px; left:-12px;" data-topo-line-target="circle">
          <%= link_to problem_friendly_path(secondary_line.problem) do %>
            <%= problem_circle_view(secondary_line.problem) %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>

  <% if line.coordinates %>
    <div class="absolute" style="left:<%= line.coordinates.first['x']*100 %>%; top:<%= line.coordinates.first['y']*100 %>%">
      <div class="relative hidden" style="top:-12px; left:-12px;" data-topo-line-target="circle">
        <%= problem_circle_view(line.problem) %>
      </div>
    </div>
  <% end %>
</div>